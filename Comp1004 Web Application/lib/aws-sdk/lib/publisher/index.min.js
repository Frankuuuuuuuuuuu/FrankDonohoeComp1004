/**
 * Minified by jsDelivr using Terser v5.15.1.
 * Original file: /npm/aws-sdk@2.1342.0/lib/publisher/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var util=require("../core").util,dgram=require("dgram"),stringToBuffer=util.buffer.toBuffer,MAX_MESSAGE_SIZE=8192;function Publisher(t){t=t||{},this.enabled=t.enabled||!1,this.port=t.port||31e3,this.clientId=t.clientId||"",this.address=t.host||"127.0.0.1",this.clientId.length>255&&(this.clientId=this.clientId.substr(0,255)),this.messagesInFlight=0}Publisher.prototype.fieldsToTrim={UserAgent:256,SdkException:128,SdkExceptionMessage:512,AwsException:128,AwsExceptionMessage:512,FinalSdkException:128,FinalSdkExceptionMessage:512,FinalAwsException:128,FinalAwsExceptionMessage:512},Publisher.prototype.trimFields=function(t){for(var e=Object.keys(this.fieldsToTrim),i=0,s=e.length;i<s;i++){var n=e[i];if(t.hasOwnProperty(n)){var r=this.fieldsToTrim[n],l=t[n];l&&l.length>r&&(t[n]=l.substr(0,r))}}return t},Publisher.prototype.eventHandler=function(t){t.ClientId=this.clientId,this.trimFields(t);var e=stringToBuffer(JSON.stringify(t));!this.enabled||e.length>MAX_MESSAGE_SIZE||this.publishDatagram(e)},Publisher.prototype.publishDatagram=function(t){var e=this;this.getClient();this.messagesInFlight++,this.client.send(t,0,t.length,this.port,this.address,(function(t,i){--e.messagesInFlight<=0&&e.destroyClient()}))},Publisher.prototype.getClient=function(){return this.client||(this.client=dgram.createSocket("udp4")),this.client},Publisher.prototype.destroyClient=function(){this.client&&(this.client.close(),this.client=void 0)},module.exports={Publisher:Publisher};
//# sourceMappingURL=/sm/1df4abf52cbfc3f79e6c8c9766bfe1f97335c37ad77640c2d111fd190c834ebf.map