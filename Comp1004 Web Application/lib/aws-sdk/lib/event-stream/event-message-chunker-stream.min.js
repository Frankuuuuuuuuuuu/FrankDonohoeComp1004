/**
 * Minified by jsDelivr using Terser v5.15.1.
 * Original file: /npm/aws-sdk@2.1342.0/lib/event-stream/event-message-chunker-stream.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var util=require("../core").util,Transform=require("stream").Transform,allocBuffer=util.buffer.alloc;function EventMessageChunkerStream(e){Transform.call(this,e),this.currentMessageTotalLength=0,this.currentMessagePendingLength=0,this.currentMessage=null,this.messageLengthBuffer=null}EventMessageChunkerStream.prototype=Object.create(Transform.prototype),EventMessageChunkerStream.prototype._transform=function(e,t,s){for(var n=e.length,r=0;r<n;){if(!this.currentMessage){var a=n-r;this.messageLengthBuffer||(this.messageLengthBuffer=allocBuffer(4));var g=Math.min(4-this.currentMessagePendingLength,a);if(e.copy(this.messageLengthBuffer,this.currentMessagePendingLength,r,r+g),this.currentMessagePendingLength+=g,r+=g,this.currentMessagePendingLength<4)break;this.allocateMessage(this.messageLengthBuffer.readUInt32BE(0)),this.messageLengthBuffer=null}var h=Math.min(this.currentMessageTotalLength-this.currentMessagePendingLength,n-r);e.copy(this.currentMessage,this.currentMessagePendingLength,r,r+h),this.currentMessagePendingLength+=h,r+=h,this.currentMessageTotalLength&&this.currentMessageTotalLength===this.currentMessagePendingLength&&(this.push(this.currentMessage),this.currentMessage=null,this.currentMessageTotalLength=0,this.currentMessagePendingLength=0)}s()},EventMessageChunkerStream.prototype._flush=function(e){this.currentMessageTotalLength?this.currentMessageTotalLength===this.currentMessagePendingLength?e(null,this.currentMessage):e(new Error("Truncated event message received.")):e()},EventMessageChunkerStream.prototype.allocateMessage=function(e){if("number"!=typeof e)throw new Error("Attempted to allocate an event message where size was not a number: "+e);this.currentMessageTotalLength=e,this.currentMessagePendingLength=4,this.currentMessage=allocBuffer(e),this.currentMessage.writeUInt32BE(e,0)},module.exports={EventMessageChunkerStream:EventMessageChunkerStream};
//# sourceMappingURL=/sm/b426459f71910fb68b7b8d871c143a64d12310c1cac1e83fbbc3748770ce6a0f.map