/**
 * Minified by jsDelivr using Terser v5.15.1.
 * Original file: /npm/aws-sdk@2.1342.0/lib/cloudfront/signer.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var AWS=require("../core"),url=AWS.util.url,crypto=AWS.util.crypto.lib,base64Encode=AWS.util.base64.encode,inherit=AWS.util.inherit,queryEncode=function(e){var r={"+":"-","=":"_","/":"~"};return e.replace(/[\+=\/]/g,(function(e){return r[e]}))},signPolicy=function(e,r){var t=crypto.createSign("RSA-SHA1");return t.write(e),queryEncode(t.sign(r,"base64"))},signWithCannedPolicy=function(e,r,t,i){var n=JSON.stringify({Statement:[{Resource:e,Condition:{DateLessThan:{"AWS:EpochTime":r}}}]});return{Expires:r,"Key-Pair-Id":t,Signature:signPolicy(n.toString(),i)}},signWithCustomPolicy=function(e,r,t){return e=e.replace(/\s/gm,""),{Policy:queryEncode(base64Encode(e)),"Key-Pair-Id":r,Signature:signPolicy(e,t)}},determineScheme=function(e){var r=e.split("://");if(r.length<2)throw new Error("Invalid URL.");return r[0].replace("*","")},getRtmpUrl=function(e){var r=url.parse(e);return r.path.replace(/^\//,"")+(r.hash||"")},getResource=function(e){switch(determineScheme(e)){case"http":case"https":return e;case"rtmp":return getRtmpUrl(e);default:throw new Error("Invalid URI scheme. Scheme must be one of http, https, or rtmp")}},handleError=function(e,r){if(!r||"function"!=typeof r)throw e;r(e)},handleSuccess=function(e,r){if(!r||"function"!=typeof r)return e;r(null,e)};AWS.CloudFront.Signer=inherit({constructor:function(e,r){if(void 0===e||void 0===r)throw new Error("A key pair ID and private key are required");this.keyPairId=e,this.privateKey=r},getSignedCookie:function(e,r){var t="policy"in e?signWithCustomPolicy(e.policy,this.keyPairId,this.privateKey):signWithCannedPolicy(e.url,e.expires,this.keyPairId,this.privateKey),i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i["CloudFront-"+n]=t[n]);return handleSuccess(i,r)},getSignedUrl:function(e,r){try{var t=getResource(e.url)}catch(e){return handleError(e,r)}var i=url.parse(e.url,!0),n=Object.prototype.hasOwnProperty.call(e,"policy")?signWithCustomPolicy(e.policy,this.keyPairId,this.privateKey):signWithCannedPolicy(t,e.expires,this.keyPairId,this.privateKey);for(var o in i.search=null,n)Object.prototype.hasOwnProperty.call(n,o)&&(i.query[o]=n[o]);try{var c="rtmp"===determineScheme(e.url)?getRtmpUrl(url.format(i)):url.format(i)}catch(e){return handleError(e,r)}return handleSuccess(c,r)}}),module.exports=AWS.CloudFront.Signer;
//# sourceMappingURL=/sm/02c48dcbaa094957d79efb9a39b6c43dc425f270b08fa7401d55a8d6616fb808.map