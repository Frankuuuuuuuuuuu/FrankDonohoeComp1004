/**
 * Minified by jsDelivr using Terser v5.15.1.
 * Original file: /npm/aws-sdk@2.1342.0/lib/http/node.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var AWS=require("../core"),Stream=AWS.util.stream.Stream,TransformStream=AWS.util.stream.Transform,ReadableStream=AWS.util.stream.Readable;require("../http");var CONNECTION_REUSE_ENV_NAME="AWS_NODEJS_CONNECTION_REUSE_ENABLED";AWS.NodeHttpClient=AWS.util.inherit({handleRequest:function(e,t,r,o){var n=this,i=e.endpoint,a="";t||(t={}),t.proxy&&(a=i.protocol+"//"+i.hostname,80!==i.port&&443!==i.port&&(a+=":"+i.port),i=new AWS.Endpoint(t.proxy));var s="https:"===i.protocol,l=s?require("https"):require("http"),d={host:i.hostname,port:i.port,method:e.method,headers:e.headers,path:a+e.path};t.agent||(d.agent=this.getAgent(s,{keepAlive:"1"===process.env[CONNECTION_REUSE_ENV_NAME]})),AWS.util.update(d,t),delete d.proxy,delete d.timeout;var u,c=l.request(d,(function(e){c.didCallback||(r(e),e.emit("headers",e.statusCode,e.headers,e.statusMessage))}));(e.stream=c,c.didCallback=!1,t.connectTimeout)&&c.on("socket",(function(e){e.connecting&&(u=setTimeout((function(){c.didCallback||(c.didCallback=!0,c.abort(),o(AWS.util.error(new Error("Socket timed out without establishing a connection"),{code:"TimeoutError"})))}),t.connectTimeout),e.on("connect",(function(){clearTimeout(u),u=null})))}));return c.setTimeout(t.timeout||0,(function(){if(!c.didCallback){c.didCallback=!0;var e="Connection timed out after "+t.timeout+"ms";o(AWS.util.error(new Error(e),{code:"TimeoutError"})),c.abort()}})),c.on("error",(function(e){u&&(clearTimeout(u),u=null),c.didCallback||(c.didCallback=!0,"ECONNRESET"===e.code||"EPIPE"===e.code||"ETIMEDOUT"===e.code?o(AWS.util.error(e,{code:"TimeoutError"})):o(e))})),"100-continue"===(e.headers.Expect||e.headers.expect)?c.once("continue",(function(){n.writeBody(c,e)})):this.writeBody(c,e),c},writeBody:function(e,t){var r=t.body,o=parseInt(t.headers["Content-Length"],10);if(r instanceof Stream){var n=this.progressStream(e,o);n?r.pipe(n).pipe(e):r.pipe(e)}else r?(e.once("finish",(function(){e.emit("sendProgress",{loaded:o,total:o})})),e.end(r)):e.end()},getAgent:function(e,t){var r=e?require("https"):require("http");return e?(AWS.NodeHttpClient.sslAgent||(AWS.NodeHttpClient.sslAgent=new r.Agent(AWS.util.merge({rejectUnauthorized:"0"!==process.env.NODE_TLS_REJECT_UNAUTHORIZED},t||{})),AWS.NodeHttpClient.sslAgent.setMaxListeners(0),Object.defineProperty(AWS.NodeHttpClient.sslAgent,"maxSockets",{enumerable:!0,get:function(){var e=r.globalAgent;return e&&e.maxSockets!==1/0&&"number"==typeof e.maxSockets?e.maxSockets:50}})),AWS.NodeHttpClient.sslAgent):(AWS.NodeHttpClient.agent||(AWS.NodeHttpClient.agent=new r.Agent(t)),AWS.NodeHttpClient.agent)},progressStream:function(e,t){if(void 0!==TransformStream){var r=0,o=new TransformStream;return o._transform=function(o,n,i){o&&(r+=o.length,e.emit("sendProgress",{loaded:r,total:t})),i(null,o)},o}},emitter:null}),AWS.HttpClient.prototype=AWS.NodeHttpClient.prototype,AWS.HttpClient.streamsApiVersion=ReadableStream?2:1;
//# sourceMappingURL=/sm/871f4fcfa6e38e34d173934c08ee2f5c6087c88932e1bce69b16859b0d8f4d90.map