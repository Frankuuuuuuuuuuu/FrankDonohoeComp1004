/**
 * Minified by jsDelivr using Terser v5.15.1.
 * Original file: /npm/aws-sdk@2.1342.0/lib/credentials/remote_credentials.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var AWS=require("../core"),ENV_RELATIVE_URI="AWS_CONTAINER_CREDENTIALS_RELATIVE_URI",ENV_FULL_URI="AWS_CONTAINER_CREDENTIALS_FULL_URI",ENV_AUTH_TOKEN="AWS_CONTAINER_AUTHORIZATION_TOKEN",FULL_URI_UNRESTRICTED_PROTOCOLS=["https:"],FULL_URI_ALLOWED_PROTOCOLS=["http:","https:"],FULL_URI_ALLOWED_HOSTNAMES=["localhost","127.0.0.1"],RELATIVE_URI_HOST="169.254.170.2";AWS.RemoteCredentials=AWS.util.inherit(AWS.Credentials,{constructor:function(e){AWS.Credentials.call(this),(e=e?AWS.util.copy(e):{}).httpOptions||(e.httpOptions={}),e.httpOptions=AWS.util.merge(this.httpOptions,e.httpOptions),AWS.util.update(this,e)},httpOptions:{timeout:1e3},maxRetries:3,isConfiguredForEcsCredentials:function(){return Boolean(process&&process.env&&(process.env[ENV_RELATIVE_URI]||process.env[ENV_FULL_URI]))},getECSFullUri:function(){if(process&&process.env){var e=process.env[ENV_RELATIVE_URI],r=process.env[ENV_FULL_URI];if(e)return"http://"+RELATIVE_URI_HOST+e;if(r){var t=AWS.util.urlParse(r);if(FULL_URI_ALLOWED_PROTOCOLS.indexOf(t.protocol)<0)throw AWS.util.error(new Error("Unsupported protocol:  AWS.RemoteCredentials supports "+FULL_URI_ALLOWED_PROTOCOLS.join(",")+" only; "+t.protocol+" requested."),{code:"ECSCredentialsProviderFailure"});if(FULL_URI_UNRESTRICTED_PROTOCOLS.indexOf(t.protocol)<0&&FULL_URI_ALLOWED_HOSTNAMES.indexOf(t.hostname)<0)throw AWS.util.error(new Error("Unsupported hostname: AWS.RemoteCredentials only supports "+FULL_URI_ALLOWED_HOSTNAMES.join(",")+" for "+t.protocol+"; "+t.protocol+"//"+t.hostname+" requested."),{code:"ECSCredentialsProviderFailure"});return r}throw AWS.util.error(new Error("Variable "+ENV_RELATIVE_URI+" or "+ENV_FULL_URI+" must be set to use AWS.RemoteCredentials."),{code:"ECSCredentialsProviderFailure"})}throw AWS.util.error(new Error("No process info available"),{code:"ECSCredentialsProviderFailure"})},getECSAuthToken:function(){if(process&&process.env&&process.env[ENV_FULL_URI])return process.env[ENV_AUTH_TOKEN]},credsFormatIsValid:function(e){return!!(e.accessKeyId&&e.secretAccessKey&&e.sessionToken&&e.expireTime)},formatCreds:function(e){return e.credentials&&(e=e.credentials),{expired:!1,accessKeyId:e.accessKeyId||e.AccessKeyId,secretAccessKey:e.secretAccessKey||e.SecretAccessKey,sessionToken:e.sessionToken||e.Token,expireTime:new Date(e.expiration||e.Expiration)}},request:function(e,r){var t=new AWS.HttpRequest(e);t.method="GET",t.headers.Accept="application/json";var o=this.getECSAuthToken();o&&(t.headers.Authorization=o),AWS.util.handleRequestWithRetries(t,this,r)},refresh:function(e){this.coalesceRefresh(e||AWS.util.fn.callback)},load:function(e){var r,t=this;try{r=this.getECSFullUri()}catch(r){return void e(r)}this.request(r,(function(r,o){if(!r)try{o=JSON.parse(o);var s=t.formatCreds(o);if(!t.credsFormatIsValid(s))throw AWS.util.error(new Error("Response data is not in valid format"),{code:"ECSCredentialsProviderFailure"});AWS.util.update(t,s)}catch(e){r=e}e(r,s)}))}});
//# sourceMappingURL=/sm/19ff8973f2f5b8e7d5929cce56d171ac8edc1b9cdf7afc846e2e518f6c42dd7c.map