/**
 * Minified by jsDelivr using Terser v5.15.1.
 * Original file: /npm/aws-sdk@2.1342.0/lib/credentials/ec2_metadata_credentials.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var AWS=require("../core");require("../metadata_service"),AWS.EC2MetadataCredentials=AWS.util.inherit(AWS.Credentials,{constructor:function(e){AWS.Credentials.call(this),e=e?AWS.util.copy(e):{},(e=AWS.util.merge({maxRetries:this.defaultMaxRetries},e)).httpOptions||(e.httpOptions={}),e.httpOptions=AWS.util.merge({timeout:this.defaultTimeout,connectTimeout:this.defaultConnectTimeout},e.httpOptions),this.metadataService=new AWS.MetadataService(e),this.logger=e.logger||AWS.config&&AWS.config.logger},defaultTimeout:1e3,defaultConnectTimeout:1e3,defaultMaxRetries:3,originalExpiration:void 0,refresh:function(e){this.coalesceRefresh(e||AWS.util.fn.callback)},load:function(e){var t=this;t.metadataService.loadCredentials((function(i,a){i?t.hasLoadedCredentials()?(t.extendExpirationIfExpired(),e()):e(i):(t.setCredentials(a),t.extendExpirationIfExpired(),e())}))},hasLoadedCredentials:function(){return this.AccessKeyId&&this.secretAccessKey},extendExpirationIfExpired:function(){if(this.needsRefresh()){this.originalExpiration=this.originalExpiration||this.expireTime,this.expired=!1;var e=900+Math.floor(5*Math.random()*60),t=AWS.util.date.getDate().getTime();this.expireTime=new Date(t+1e3*e),this.logger.warn("Attempting credential expiration extension due to a credential service availability issue. A refresh of these credentials will be attempted again at "+this.expireTime+"\nFor more information, please visit: https://docs.aws.amazon.com/sdkref/latest/guide/feature-static-credentials.html")}},setCredentials:function(e){var t=AWS.util.date.getDate().getTime(),i=new Date(e.Expiration);this.expired=t>=i,this.metadata=e,this.accessKeyId=e.AccessKeyId,this.secretAccessKey=e.SecretAccessKey,this.sessionToken=e.Token,this.expireTime=i}});
//# sourceMappingURL=/sm/a73581a83a5d2541cec75e09fcc349cd6adbf5bcc0d8f048faffac6130ba8ae8.map