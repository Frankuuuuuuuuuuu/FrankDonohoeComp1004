/**
 * Minified by jsDelivr using Terser v5.15.1.
 * Original file: /npm/aws-sdk@2.1342.0/scripts/changelog/util.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var changelog,latest,nextReleaseFiles,fs=require("fs"),changelogFile=process.cwd()+"/CHANGELOG.md",changesDir=process.cwd()+"/.changes/",nextReleaseDir=changesDir+"next-release/",insertMarker="\x3c!--ENTRYINSERT--\x3e",versionMarker=["\x3c!--LATEST=","--\x3e"],startContent="# Changelog for AWS SDK for JavaScript\n"+versionMarker.join("0.0.0")+"\n"+insertMarker,versionRegStr="(\\d+)\\.(\\d+)\\.(\\d+)",versionReg=new RegExp("^"+versionRegStr+"$"),versionMarkerReg=new RegExp(versionMarker.join(versionRegStr)),versionJsonFileReg=new RegExp("^"+versionRegStr+"\\.json$");function fsSyncFromRoot(e,r){try{var n=fs[e+"Sync"](r)}catch(e){throw"ENOENT"===e.code&&(e.message+=". Make sure to run from sdk root directory"),e}return n}function readChangelog(){return changelog=fsSyncFromRoot("readFile",changelogFile).toString()}function getLatestVersion(){changelog||readChangelog();var e=changelog.match(versionMarkerReg);return latest={major:parseInt(e[1],10),minor:parseInt(e[2],10),patch:parseInt(e[3],10)}}function checkAndNormalizeVersion(e){latest||getLatestVersion();var r=e.match(versionReg);if(r){var n=parseInt(r[1],10),o=parseInt(r[2],10),t=parseInt(r[3],10);if(n<latest.major||n==latest.major&&o<latest.minor||n==latest.major&&o==latest.minor&&t<=latest.patch)throw new Error("Version must be greater than latest version");return n+"."+o+"."+t}throw new Error("Provided input version is in wrong format")}function bumpMajor(){return latest||getLatestVersion(),latest.major+1+".0.0"}function bumpMinor(){return latest||getLatestVersion(),latest.major+"."+(latest.minor+1)+".0"}function bumpPatch(){return latest||getLatestVersion(),latest.major+"."+latest.minor+"."+(latest.patch+1)}function listVersions(){return fsSyncFromRoot("readdir",changesDir).map((function(e){return e.match(versionJsonFileReg)})).filter((function(e){return!!e})).sort((function(e,r){for(var n,o=1;o<=3;o++)if(0!==(n=e[o]-r[o]))return n;return 0})).map((function(e){return e.slice(1).join(".")}))}function listNextReleaseFiles(){if(!(nextReleaseFiles=fsSyncFromRoot("readdir",nextReleaseDir).map((function(e){return nextReleaseDir+e}))).length)throw new Error("No changes to be released");return nextReleaseFiles}function startNewChangelog(){return changelog=startContent}function checkChangeFormat(e){if(!e.type||!e.category||!e.description||"string"!=typeof e.type||"string"!=typeof e.category||"string"!=typeof e.description){var r=new Error("JSON not in correct format");throw r.code="InvalidFormat",r}}function readChangesFromJSON(e){var r=JSON.parse(fsSyncFromRoot("readFile",e));if(Array.isArray(r)||(r=[r]),!r.length)throw new Error(e+" contains no changes");try{r.forEach(checkChangeFormat)}catch(r){throw"InvalidFormat"===r.code&&(r.message+=" in "+e),r}return r}function addVersionJSONToChangelog(e,r){changelog||readChangelog();var n="\n\n## "+e;r.forEach((function(e){n+="\n* "+e.type+": "+e.category+": "+e.description}));var o=changelog.split(insertMarker);o[0]=o[0].replace(versionMarkerReg,versionMarker.join(e))+insertMarker,changelog=o.join(n)}function readVersionJSONAndAddToChangelog(e){addVersionJSONToChangelog(e,readChangesFromJSON(changesDir+e+".json"))}function writeToChangelog(){if(!changelog)throw new Error("Nothing to write");fs.writeFileSync(changelogFile,changelog),console.log("Successfully updated CHANGELOG")}function writeToVersionJSON(e,r){var n=JSON.stringify(r,null,4);fs.writeFileSync(changesDir+e+".json",n),console.log("Successfully added "+e+".json to "+changesDir)}function clearNextReleaseDir(){nextReleaseFiles||listNextReleaseFiles(),nextReleaseFiles.forEach((function(e){fsSyncFromRoot("unlink",e)})),console.log(nextReleaseDir+" has been cleared")}module.exports={readChangelog:readChangelog,getLatestVersion:getLatestVersion,checkAndNormalizeVersion:checkAndNormalizeVersion,bumpMajor:bumpMajor,bumpMinor:bumpMinor,bumpPatch:bumpPatch,listVersions:listVersions,listNextReleaseFiles:listNextReleaseFiles,startNewChangelog:startNewChangelog,readChangesFromJSON:readChangesFromJSON,addVersionJSONToChangelog:addVersionJSONToChangelog,readVersionJSONAndAddToChangelog:readVersionJSONAndAddToChangelog,writeToChangelog:writeToChangelog,writeToVersionJSON:writeToVersionJSON,clearNextReleaseDir:clearNextReleaseDir};
//# sourceMappingURL=/sm/ce6d2db2ddc04decbca5a0f95f22ef269f0a95efad38d888884941d7de86323d.map